{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/utils.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["import { observeArray } from './index'\r\nconst OBSERVE_ARRAY = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'sort',\r\n    'reverse',\r\n    'splice'\r\n]\r\n\r\n\r\nvar orgArrMethods = Array.prototype;// 获取数组方法原型\r\n\r\nvar arrayMethods = Object.create(orgArrMethods);//创建数组对象\r\n\r\nOBSERVE_ARRAY.map(function (m) {\r\n    arrayMethods[m] = function () {\r\n        console.log(this);\r\n        var methodsArg = Array.prototype.slice.call(arguments); //获取方法传入的数据\r\n        orgArrMethods[m].apply(this, methodsArg) //调用相应方法 这里不能使用arrayMethods数组对象的方法 会死循环\r\n        var newArray;\r\n        switch (m) {\r\n            case 'push':\r\n            case 'unshift':\r\n                newArray = methodsArg // 这里应为传入得数据\r\n                break;\r\n            case 'splice':\r\n                newArray = methodsArg.slice(2)\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        console.log(newArray);\r\n        // var vm= new Vue({el:'#app',data(){return {a:[{b:{c:'hhhh'},d:5}]}}})\r\n        newArray && observeArray(newArray)\r\n        // return rt\r\n    }\r\n})\r\n\r\nexport {\r\n    arrayMethods\r\n}","import { arrayMethods } from './array'\r\n\r\n// 处理对象数据 添加响应式\r\nfunction defineReactiveData(data, key, value) {\r\n\r\n    observe(value) // 递归添加观察者 监听数据\r\n\r\n    Object.defineProperty(data, key, {\r\n        set(newValue) {\r\n            // 判断是否新值 是则替换旧值\r\n            if (newValue === value) return;\r\n            observe(newValue) // 在设置值得时候也有能是对象,数组 所以在此需要在地调用观察者\r\n            value = newValue\r\n        },\r\n        get() {\r\n            // console.log('获取响应式数据：key ' + key + '; value ', value);\r\n            return value\r\n        }\r\n    })\r\n}\r\n\r\nfunction Observer(data) {\r\n    if (Array.isArray(data)) {\r\n        data.__proto__ = arrayMethods // 为原型链上添加我们处理过的方法 方法调用查找时优先找到这里\r\n        observeArray(data)\r\n    } else {\r\n        this.walk(data)\r\n    }\r\n}\r\n\r\n// 添加walk方法 处理对象数据\r\nObserver.prototype.walk = function (data) {\r\n    var keys = Object.keys(data)\r\n    for (var i = 0; i < keys.length; i++) {\r\n        var key = keys[i]\r\n        var value = data[key]\r\n        defineReactiveData(data, key, value)\r\n    }\r\n}\r\n\r\n/*\r\n* 观察者\r\n*/\r\n\r\nfunction observe(data) {\r\n    console.log(data, 'prototype');\r\n    if (typeof data !== 'object' || data === null) return;\r\n\r\n    // 当数据没有问题交由观察者进行观察\r\n    new Observer(data)\r\n}\r\n\r\n\r\n\r\n\r\n// 处理 数组数据\r\nfunction observeArray(data) {\r\n\r\n    for (var i = 0; i < data.length; i++) {\r\n        observe(data[i]) // 观察数组每一项元素 \r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport { observe, observeArray }\r\n\r\n","//数据代理\r\nfunction proxyData(vm, target, key) {\r\n\r\n    //数据劫持将 vm._data.xxx 变为 vm.xxx\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[target][key]\r\n        },\r\n        set(newValue) {\r\n            return vm[target][key] = newValue\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport {\r\n    proxyData\r\n}","import { observe } from './observer/index'\r\nimport { proxyData } from './utils'\r\n\r\nfunction initState(vm) {\r\n    const options = vm.$options\r\n\r\n    if (options.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    var data = vm.$options.data\r\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data || {} // 使用call改变指向 可以使用\r\n    for (let key in data) {\r\n        //使用代理处理原始数据 劫持数据增加访问、设置的入口\r\n        proxyData(vm, '_data', key)\r\n    }\r\n    // 观察 响应式数据处理\r\n    observe(data)\r\n}\r\n\r\nexport {\r\n    initState\r\n}","import { initState } from './state'\r\n\r\nfunction initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n\r\n        vm.$options = options;\r\n\r\n        initState(vm)\r\n    }\r\n}\r\n\r\nexport {\r\n    initMixin\r\n}","import { initMixin } from './init'\r\n\r\nfunction Vue(options) {\r\n\r\n    //初始化\r\n    this._init(options)\r\n}\r\n\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":[],"mappings":"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"}